<?xml version="1.0" encoding="UTF-8"?>

<?import java.lang.*?>
<?import javafx.geometry.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.effect.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.Pagination?>
<?import javafx.scene.control.Tab?>
<?import javafx.scene.control.TabPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.text.Text?>
<?import javafx.scene.effect.DropShadow?>
<?import javafx.scene.paint.Color?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.control.DatePicker?>

<VBox prefHeight="600.0" prefWidth="831.0" style="-fx-background-color: linear-gradient(to bottom right, #2c3e50, #4a69bd);" stylesheets="@application.css" xmlns="http://javafx.com/javafx/8" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.controllers.FinanceController">
    <padding>
        <Insets bottom="20" left="20" right="20" top="20" />
    </padding>
    <spacing>15</spacing>
    <children>
        <HBox alignment="CENTER_LEFT" spacing="15">
            <children>
                <Label style="-fx-font-family: 'Font Awesome 5 Free', 'Segoe UI'; -fx-font-size: 28px; -fx-text-fill: #ecf0f1; -fx-font-weight: 900;" text="ﭭ" />
                <Text fill="#ecf0f1" style="-fx-font-size: 28px; -fx-font-weight: bold;" text="Gestion Financière">
                    <effect>
                        <DropShadow color="#00000066" offsetX="0.0" offsetY="2.0" radius="5.0" />
                    </effect>
                </Text>
            </children>
        </HBox>

        <VBox fx:id="adminInfoBox" spacing="5">
            <children>
                <HBox spacing="20">
                   <children>
                       <Label fx:id="adminNameLabel" style="-fx-font-size: 14px; -fx-text-fill: #ecf0f1;" />
                       <Label fx:id="dateTimeLabel" style="-fx-font-size: 14px; -fx-text-fill: #ecf0f1;" />
                   </children>
                </HBox>
                <HBox spacing="20">
                   <children>
                       <Label fx:id="totalVentesLabel" style="-fx-font-size: 14px; -fx-font-weight: bold; -fx-text-fill: #ecf0f1;" />
                       <Label fx:id="totalReservationsLabel" style="-fx-font-size: 14px; -fx-font-weight: bold; -fx-text-fill: #ecf0f1;" />
                   </children>
                </HBox>
                <Button onAction="#generateDailyPdf" style="-fx-background-color: #27ae60; -fx-text-fill: white; -fx-font-size: 14px; -fx-padding: 10px 20px; -fx-border-radius: 5px; -fx-background-radius: 5px; -fx-cursor: hand;" text="Générer Rapport Journalier PDF">
                    <effect>
                        <DropShadow color="#00000033" offsetX="0.0" offsetY="2.0" radius="5.0" />
                    </effect>
                </Button>
            </children>
        </VBox>

        <TabPane fx:id="mainTabPane" prefWidth="804.0" styleClass="finance-tab-pane" VBox.vgrow="ALWAYS">
            <tabs>
                <!-- Onglet Ventes -->
                <Tab fx:id="ventesTab" text="Ventes">
                    <content>
                        <AnchorPane style="-fx-background-color: #ffffff; -fx-padding: 10px; -fx-background-radius: 0 5px 5px 5px;">
                            <effect>
                                <DropShadow color="#0000001a" offsetX="0.0" offsetY="2.0" radius="5.0" />
                            </effect>
                            <children>
                                <VBox spacing="10" AnchorPane.bottomAnchor="0.0" AnchorPane.leftAnchor="0.0" AnchorPane.rightAnchor="0.0" AnchorPane.topAnchor="0.0">
                                    <padding>
                                        <Insets bottom="10" left="10" right="10" top="10" />
                                    </padding>
                                    <children>
                                        <Label style="-fx-text-fill: #34495e; -fx-font-size: 18px; -fx-font-weight: bold;" text="Ventes (Réservations et Paiements)" />
                                        <HBox alignment="CENTER_LEFT" spacing="10">
                                            <children>
                                                <TextField fx:id="searchVenteField" prefWidth="250" promptText="Rechercher par ticket, client, mode de paiement..." style="-fx-background-color: #ffffff; -fx-border-color: #bdc3c7; -fx-border-radius: 5px; -fx-background-radius: 5px; -fx-font-size: 14px; -fx-padding: 8px 10px; -fx-prompt-text-fill: #7f8c8d;">
                                                    <effect>
                                                        <DropShadow color="#0000001a" offsetX="0.0" offsetY="1.0" radius="3.0" />
                                                    </effect>
                                                </TextField>
                                            </children>
                                        </HBox>
                                        <TableView fx:id="ventesTable" style="-fx-background-color: transparent; -fx-border-color: #bdc3c7; -fx-border-radius: 5px; -fx-background-radius: 5px;" VBox.vgrow="ALWAYS">
                                            <columns>
                                                <TableColumn fx:id="numeroTicketVenteColumn" prefWidth="120" style="-fx-background-color: #34495e; -fx-text-fill: white; -fx-font-weight: bold; -fx-border-color: #ecf0f1;" text="Numéro Ticket" />
                                                <TableColumn fx:id="clientVenteColumn" prefWidth="120" style="-fx-background-color: #34495e; -fx-text-fill: white; -fx-font-weight: bold; -fx-border-color: #ecf0f1;" text="Client" />
                                                <TableColumn fx:id="montantTotalVenteColumn" prefWidth="100" style="-fx-background-color: #34495e; -fx-text-fill: white; -fx-font-weight: bold; -fx-border-color: #ecf0f1;" text="Montant Total" />
                                                <TableColumn fx:id="modePaiementVenteColumn" prefWidth="120" style="-fx-background-color: #34495e; -fx-text-fill: white; -fx-font-weight: bold; -fx-border-color: #ecf0f1;" text="Mode de Paiement" />
                                                <TableColumn fx:id="dateHeureVenteColumn" prefWidth="160" style="-fx-background-color: #34495e; -fx-text-fill: white; -fx-font-weight: bold; -fx-border-color: #ecf0f1;" text="Date et Heure" />
                                            </columns>
                                            <columnResizePolicy>
                                                <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                                            </columnResizePolicy>
                                        </TableView>
                                        <Pagination fx:id="ventesPagination" />
                                    </children>
                                </VBox>
                            </children>
                        </AnchorPane>
                    </content>
                </Tab>

                <!-- Onglet Stock -->
                <Tab fx:id="stockTab" text="Stock">
                    <content>
                        <AnchorPane style="-fx-background-color: #ffffff; -fx-padding: 10px; -fx-background-radius: 0 5px 5px 5px;">
                            <effect>
                                <DropShadow color="#0000001a" offsetX="0.0" offsetY="2.0" radius="5.0" />
                            </effect>
                            <children>
                                <VBox spacing="10" AnchorPane.bottomAnchor="0.0" AnchorPane.leftAnchor="0.0" AnchorPane.rightAnchor="0.0" AnchorPane.topAnchor="0.0">
                                    <padding>
                                        <Insets bottom="10" left="10" right="10" top="10" />
                                    </padding>
                                    <children>
                                        <Label style="-fx-text-fill: #34495e; -fx-font-size: 18px; -fx-font-weight: bold;" text="Stock (Produits et Prix)" />
                                        <HBox alignment="CENTER_LEFT" spacing="10">
                                            <children>
                                                <TextField fx:id="searchStockField" prefWidth="250" promptText="Rechercher par nom de produit..." style="-fx-background-color: #ffffff; -fx-border-color: #bdc3c7; -fx-border-radius: 5px; -fx-background-radius: 5px; -fx-font-size: 14px; -fx-padding: 8px 10px; -fx-prompt-text-fill: #7f8c8d;">
                                                    <effect>
                                                        <DropShadow color="#0000001a" offsetX="0.0" offsetY="1.0" radius="3.0" />
                                                    </effect>
                                                </TextField>
                                            </children>
                                        </HBox>
                                        <TableView fx:id="stockTable" style="-fx-background-color: transparent; -fx-border-color: #bdc3c7; -fx-border-radius: 5px; -fx-background-radius: 5px;" VBox.vgrow="ALWAYS">
                                            <columns>
                                                <TableColumn fx:id="nomProduitStockColumn" prefWidth="180" style="-fx-background-color: #34495e; -fx-text-fill: white; -fx-font-weight: bold; -fx-border-color: #ecf0f1;" text="Nom du Produit" />
                                                <TableColumn fx:id="prixProduitStockColumn" prefWidth="100" style="-fx-background-color: #34495e; -fx-text-fill: white; -fx-font-weight: bold; -fx-border-color: #ecf0f1;" text="Prix" />
                                                <TableColumn fx:id="stockProduitStockColumn" prefWidth="100" style="-fx-background-color: #34495e; -fx-text-fill: white; -fx-font-weight: bold; -fx-border-color: #ecf0f1;" text="Stock" />
                                                <TableColumn fx:id="dateAjoutStockColumn" prefWidth="150" style="-fx-background-color: #34495e; -fx-text-fill: white; -fx-font-weight: bold; -fx-border-color: #ecf0f1;" text="Date Péremption" />
                                            </columns>
                                            <columnResizePolicy>
                                                <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                                            </columnResizePolicy>
                                        </TableView>
                                        <Pagination fx:id="stockPagination" />
                                    </children>
                                </VBox>
                            </children>
                        </AnchorPane>
                    </content>
                </Tab>

                <!-- Onglet Journal -->
                <Tab fx:id="journalTab" closable="false" text="Journal">
                    <content>
                        <AnchorPane style="-fx-background-color: #ffffff; -fx-padding: 10px; -fx-background-radius: 0 5px 5px 5px;">
                            <effect>
                                <DropShadow color="#0000001a" offsetX="0.0" offsetY="2.0" radius="5.0" />
                            </effect>
                            <children>
                                <VBox spacing="10" AnchorPane.bottomAnchor="0.0" AnchorPane.leftAnchor="0.0" AnchorPane.rightAnchor="0.0" AnchorPane.topAnchor="0.0">
                                    <padding>
                                        <Insets bottom="10" left="10" right="10" top="10" />
                                    </padding>
                                    <children>
                                        <Label style="-fx-text-fill: #34495e; -fx-font-size: 18px; -fx-font-weight: bold;" text="Journal des Opérations" />
                                        <HBox alignment="CENTER_LEFT" spacing="10">
                                            <children>
                                                <TextField fx:id="searchJournalField" prefWidth="250" promptText="Rechercher dans le journal..." style="-fx-background-color: #ffffff; -fx-border-color: #bdc3c7; -fx-border-radius: 5px; -fx-background-radius: 5px; -fx-font-size: 14px; -fx-padding: 8px 10px; -fx-prompt-text-fill: #7f8c8d;">
                                                    <effect>
                                                        <DropShadow color="#0000001a" offsetX="0.0" offsetY="1.0" radius="3.0" />
                                                    </effect>
                                                </TextField>
                                                <DatePicker fx:id="startDatePicker" promptText="Date début" style="-fx-background-color: #ffffff; -fx-border-color: #bdc3c7; -fx-border-radius: 5px; -fx-background-radius: 5px; -fx-font-size: 14px; -fx-padding: 8px 10px; -fx-prompt-text-fill: #7f8c8d;">
                                                    <effect>
                                                        <DropShadow color="#0000001a" offsetX="0.0" offsetY="1.0" radius="3.0" />
                                                    </effect>
                                                </DatePicker>
                                                <DatePicker fx:id="endDatePicker" promptText="Date fin" style="-fx-background-color: #ffffff; -fx-border-color: #bdc3c7; -fx-border-radius: 5px; -fx-background-radius: 5px; -fx-font-size: 14px; -fx-padding: 8px 10px; -fx-prompt-text-fill: #7f8c8d;">
                                                    <effect>
                                                        <DropShadow color="#0000001a" offsetX="0.0" offsetY="1.0" radius="3.0" />
                                                    </effect>
                                                </DatePicker>
                                                <Button onAction="#filterJournalByDate" style="-fx-background-color: #3498db; -fx-text-fill: white; -fx-font-size: 14px; -fx-border-radius: 5; -fx-background-radius: 5; -fx-cursor: hand;" text="Filtrer par date">
                                                    <effect>
                                                        <DropShadow color="#00000033" offsetX="0.0" offsetY="2.0" radius="5.0" />
                                                    </effect>
                                                </Button>
                                            </children>
                                        </HBox>
                                        <TableView fx:id="journalTable" style="-fx-background-color: transparent; -fx-border-color: #bdc3c7; -fx-border-radius: 5px; -fx-background-radius: 5px;" VBox.vgrow="ALWAYS">
                                            <columns>
                                                <TableColumn fx:id="journalCheckColumn" text=" " prefWidth="40" />
                                                <TableColumn fx:id="journalTypeColumn" prefWidth="116.0" style="-fx-background-color: #34495e; -fx-text-fill: white; -fx-font-weight: bold; -fx-border-color: #ecf0f1;" text="Type" />
                                                <TableColumn fx:id="journalDescriptionColumn" prefWidth="142.0" style="-fx-background-color: #34495e; -fx-text-fill: white; -fx-font-weight: bold; -fx-border-color: #ecf0f1;" text="Description" />
                                                <TableColumn fx:id="journalDateColumn" prefWidth="107.0" style="-fx-background-color: #34495e; -fx-text-fill: white; -fx-font-weight: bold; -fx-border-color: #ecf0f1;" text="Date et Heure" />
                                                <TableColumn fx:id="journalMontantColumn" prefWidth="95.0" style="-fx-background-color: #34495e; -fx-text-fill: white; -fx-font-weight: bold; -fx-border-color: #ecf0f1;" text="Montant" />
                                                <TableColumn fx:id="journalAdminColumn" prefWidth="99.0" style="-fx-background-color: #34495e; -fx-text-fill: white; -fx-font-weight: bold; -fx-border-color: #ecf0f1;" text="Admin" />
                                                <TableColumn fx:id="journalActionsColumn" prefWidth="165.0" style="-fx-background-color: #34495e; -fx-text-fill: white; -fx-font-weight: bold; -fx-border-color: #ecf0f1;" text="Actions" />
                                            </columns>
                                            <columnResizePolicy>
                                                <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                                            </columnResizePolicy>
                                        </TableView>
                                        <Pagination fx:id="journalPagination" />
                                        <Button onAction="#generateSelectedJournalPdf" style="-fx-background-color: #27ae60; -fx-text-fill: white; -fx-font-size: 14px; -fx-padding: 10px 20px; -fx-border-radius: 5px; -fx-background-radius: 5px; -fx-cursor: hand;" text="Générer PDF des lignes sélectionnées">
                                            <effect>
                                                <DropShadow color="#00000033" offsetX="0.0" offsetY="2.0" radius="5.0" />
                                            </effect>
                                        </Button>
                                    </children>
                                </VBox>
                            </children>
                        </AnchorPane>
                    </content>
                </Tab>
            </tabs>
        </TabPane>
    </children>
</VBox>
